#####################################################################
#                            OpenAlchemist                          #
#                                                                   #
#  File : MakeFile                                                  #
#  Description : Makefile generated by me				                    #
#  License : GNU General Public License 2 or +                      #
#  Author : Guillaume Delhumeau <guillaume.delhumeau@gmail.com>     #
#                                                                   #
#                                                                   #
#####################################################################

# Variables
CXX = g++
CXXFLAGS = -Wall `pkg-config --cflags clanCore-2.1 clanDisplay-2.1 clanApp-2.1 clanGL1-2.1 clanGL-2.1 clanGDI-2.1` -g -D DEBUG
LIBS = `pkg-config --libs clanCore-2.1 clanDisplay-2.1 clanApp-2.1 clanGL1-2.1 clanGL-2.1 clanGDI-2.1 clanSound-2.1 clanVorbis-2.1`
STATIC_LIBS = /usr/local/lib/libclanApp.a /usr/local/lib/libclanSDL.a /usr/local/lib/libclanDisplay.a /usr/local/lib/libclanGL.a /usr/local/lib/libclanCore.a /usr/local/lib/libclanSignals.a /usr/lib/libpng.a /usr/lib/libjpeg.a /usr/lib/libz.a /usr/lib/libXmu.a /usr/lib/libXi.a /usr/lib/libXxf86vm.a /usr/lib/libm.a /usr/lib/libGLU.a -lGL `sdl-config --static-libs`

# liste des objets à compiler
OBJS=bin/Application.o bin/AudioManager.o bin/Board.o bin/CombosPainter.o bin/CommonResources.o bin/DemoPlayer.o bin/FrameRateCounter.o bin/FrontLayer.o bin/GameEngine.o bin/HumanPlayer.o bin/IniFile.o bin/Keys.o bin/LoadingScreen.o bin/Player.o bin/Preferences.o bin/ProgressBar.o bin/Skin.o bin/SkinsManager.o bin/Window.o bin/main.o bin/memory.o bin/misc.o bin/states/CommonState.o bin/states/GameOverState.o bin/states/GameState.o bin/states/InGameState.o bin/states/MenuState.o bin/states/MenuState/BasicItem.o bin/states/MenuState/DualChoiceItem.o bin/states/MenuState/MenuItem.o bin/states/MenuState/MultipleChoicesItem.o bin/states/MenuState/TableChoicesItem.o bin/states/OptionsMenuState.o bin/states/PauseMenuState.o bin/states/QuitMenuState.o bin/states/SkinsMenuState.o bin/states/TitleState.o

# all = on compile tous les execs
all: openalchemist
	@echo "OK"

openalchemist: bin $(OBJS) skins/aqua.zip skins/brushed.zip skins/vectoriel.zip
	g++ -o openalchemist $(OBJS) $(LIBS)
static : bin $(OBJS) skins/aqua.zip skins/brushed.zip skins/vectoriel.zip
	g++ -o openalchemist-static $(OBJS) $(STATIC_LIBS)

bin/%.o : src/%.cpp
	$(CXX) -c -o $@ $? $(CXXFLAGS)

bin: 
	mkdir bin
	mkdir bin/states
	mkdir bin/states/MenuState

bin/states: bin
	mkdir bin/states

skins/aqua.zip : skins/aqua/*
	@echo "On zip le thème aqua"
	cd skins/aqua && zip -q -r ../aqua * -x *svn*
skins/brushed.zip : skins/brushed/*
	@echo "On zip le thème brushed"
	cd skins/brushed && zip -q -r ../brushed * -x *svn*
skins/vectoriel.zip : skins/vectoriel/*
	@echo "On zip le thème vectoriel"
	cd skins/vectoriel && zip -q -r ../vectoriel * -x *svn*

clean: 
	rm -f skins/*.zip
	rm -f -R bin
	rm -f openalchemist
	rm -f openalchemist-static

