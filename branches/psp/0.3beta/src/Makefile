#####################################################################
#                            OpenAlchemist                          #
#                                                                   #
#  File : MakeFile                                                  #
#  Description : Makefile generated by me				                    #
#  License : GNU General Public License 2 or +                      #
#                                                                   #
#                                                                   #
#####################################################################

# Variables
CXX = g++
SDL_CONFIG = sdl-config
PSPSDK = $(shell psp-config --pspsdk-path)
INCDIRS = -I. -I$(PSPSDK)/include
LIBDIRS = -L$(PSPSDK)/lib
DEFAULT_CFLAGS = $(INCDIRS) $(shell $(SDL_CONFIG) --cflags)
CFLAGS = $(DEFAULT_CFLAGS) -O2 -Wall -DLINUX_MODE
CXXFLAGS = $(CFLAGS) -fno-exceptions -fno-rtti
LIBS = -lstdc++ -lc -lSDL_image -lSDL -lpng -ljpeg -lz -lm
STATIC_LIBS = `sdl-config --static-libs`
BUILD_PATH = linux_built

# liste des objets à compiler
OBJS=psp_main.o psp_sdl.o InterfaceC_CPP.o GameEngine.o CommonResources.o Board.o CombosPainter.o misc.o Player.o IniFile.o Preferences.o Keys.o ProgressBar.o HumanPlayer.o DemoPlayer.o BitmapFont.o states/CommonState.o states/GameOverState.o states/InGameState.o states/OptionsMenuState.o states/PauseMenuState.o states/QuitMenuState.o states/SkinsMenuState.o states/GameState.o states/TitleState.o
# all = on compile tous les execs
all: openalchemist
	@echo "OK"

openalchemist: $(OBJS)
	g++ -o openalchemist $(OBJS) $(LIBDIRS) $(LIBS)
	mv openalchemist ..
static : $(OBJS) 
	g++ -o openalchemist-static $(OBJS) $(LIBDIRS) $(STATIC_LIBS)

bin/%.o : src/%.cpp
	$(CXX) -c -o $@ $? $(CXXFLAGS)

bin: 
	mkdir bin
	mkdir bin/states

bin/states: bin
	mkdir bin/states

skins/aqua.zip : skins/aqua/*
	@echo "On zip le thème aqua"
	cd skins/aqua && zip -q -r ../aqua * -x *svn*
skins/brushed.zip : skins/brushed/*
	@echo "On zip le thème brushed"
	cd skins/brushed && zip -q -r ../brushed * -x *svn*
skins/vectoriel.zip : skins/vectoriel/*
	@echo "On zip le thème vectoriel"
	cd skins/vectoriel && zip -q -r ../vectoriel * -x *svn*

clean: 
	#rm skins/*.zip
	#rm bin -R
	rm states/*.o
	rm *.o
	rm openalchemist
	rm openalchemist-static
